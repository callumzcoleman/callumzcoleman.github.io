<script>
  // Robust tab behaviour: ensures About opens by default and buttons are click-safe.
  (function(){
    // Ensure buttons are explicit type=button (prevents accidental form submit)
    document.querySelectorAll('.tab').forEach(btn => btn.setAttribute('type','button'));

    // Helper: show a panel and set ARIA on tabs
    function showPanel(name){
      document.querySelectorAll('.tab').forEach(t => t.setAttribute('aria-selected','false'));
      document.querySelectorAll('.tab-panels > section').forEach(s => s.hidden = true);

      const tab = document.querySelector('.tab[aria-controls="'+name+'"]');
      const panel = document.getElementById(name);
      if(tab) tab.setAttribute('aria-selected','true');
      if(panel) panel.hidden = false;
    }

    // Wire clicks using event delegation on the tab-list container
    const tabList = document.querySelector('.tab-list');
    if(tabList){
      tabList.addEventListener('click', (e) => {
        const btn = e.target.closest('.tab');
        if(!btn) return;
        const target = btn.getAttribute('aria-controls');
        if(target) showPanel(target);
      });
    }

    // Keyboard support: left/right arrow switches tabs
    document.addEventListener('keydown', (e) => {
      if(!['ArrowLeft','ArrowRight'].includes(e.key)) return;
      const tabs = Array.from(document.querySelectorAll('.tab'));
      const idx = tabs.findIndex(t => t.getAttribute('aria-selected') === 'true');
      if(idx === -1) return;
      let next = idx + (e.key === 'ArrowRight' ? 1 : -1);
      if(next < 0) next = tabs.length - 1;
      if(next >= tabs.length) next = 0;
      const name = tabs[next].getAttribute('aria-controls');
      if(name) showPanel(name);
      tabs[next].focus();
    });

    // Ensure About is default open on load
    document.addEventListener('DOMContentLoaded', () => {
      // If any tab already marked selected, respect that; otherwise open About
      const anySelected = Array.from(document.querySelectorAll('.tab')).some(t => t.getAttribute('aria-selected') === 'true');
      if(!anySelected) {
        showPanel('about');
      } else {
        // ensure the corresponding panel is visible (in case HTML and ARIA were out of sync)
        const sel = document.querySelector('.tab[aria-selected="true"]');
        const name = sel ? sel.getAttribute('aria-controls') : 'about';
        showPanel(name || 'about');
      }
    });

    // Also run immediately in case DOMContentLoaded already fired
    if(document.readyState === 'complete' || document.readyState === 'interactive'){
      const sel = document.querySelector('.tab[aria-selected="true"]');
      const name = sel ? sel.getAttribute('aria-controls') : 'about';
      showPanel(name || 'about');
    }
  })();
</script>
